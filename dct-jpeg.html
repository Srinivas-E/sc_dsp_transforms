
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>module_dct_jpeg &mdash; DSP transformations v0v1 documentation</title>
    <link rel="stylesheet" href="_static/xdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0v1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://mathjax.connectmv.com/MathJax.js"></script>
    <script type="text/javascript" src="_static/xcomment.js"></script>
    <link rel="top" title="DSP transformations v0v1 documentation" href="index.html" />
    <link rel="next" title="module_huffman_jpeg" href="huffman-jpeg.html" />
    <link rel="prev" title="module_fft" href="fft.html" /> 

<script>
function setheight() {
h1 = document.getElementById('d1').style.height;
h2 = document.getElementById('d2').style.height;

if (parseInt(h1) > parseInt(h2)) {
document.getElementById('d2').style.height=h1 + "px";
}
else {
document.getElementById('d1').style.height=h2 + "px";
}

}
</script>
</head>

<body onload="setheight();">

  

    <div class="document" id='d1'>
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
<div style="float: right">
<a href="fft.html"
                        title="previous chapter"> &lt&lt </a>
<a href="huffman-jpeg.html"
                        title="next chapter"> &gt&gt </a></p>
</div>

            
  <div class="section" id="module-dct-jpeg">
<h1>module_dct_jpeg<a class="headerlink" href="#module-dct-jpeg" title="Permalink to this headline">¶</a></h1>
<p>The DCT module comprises a heavily optimised DCT function that needs to run
in a thread of its own (since it uses all registers of the processor). The
DCT function operates in place on 8x8 blocks of 2D data. A block of data is
to be stored in memory, the address is to be passed to the function, and on
completion the pointer is returned. Between outputting the address, and
getting it back, the buffer is owned by the DCT-thread, and shall not be
used by any other thread. A common scheme would use a triple buffering
scheme, where one buffer is filled with new data, whilst a second buffer is
transformed by the DCT thread, whilst the third buffer is compressed using
the huffman module.</p>
<div class="section" id="api">
<h2>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h2>
<dt><dl class="function">
<dt id="forwardDCT">
void <tt class="descname">forwardDCT</tt><big>(</big>streaming chanend<em>&nbsp;blocks</em>, int<em>&nbsp;preprocessedQuant[65]</em><big>)</big><a class="headerlink" href="#forwardDCT" title="Permalink to this definition">¶</a></dt>
<dd><p>This function performs zero or more DCT operations, and quantises the result.</p>
<p>Each block address is sent to the DCT process over the channel, and when done the address is sent out over the channel. It is streaming so that a block can always be waiting in the channel. This function should be running inside a thread, and is interfaced to through the streaming channel.</p>
<p>The quant array should have been preprocessed using the quantDCT function.</p>
<p>The functions doDCT and endDCT can be used to interact with the forwardDCT function; if full parallelism is required, then a block address should be sent over the channel, and subsequently a block address should be input for every block address that is output. Some form of double buffering is required to make sure that <a class="reference internal" href="#forwardDCT" title="forwardDCT"><span>forwardDCT()</span></a> &#8220;owns&#8221; the buffer that it operates on.</p>
<p>This function does not return until it receives an &#8216;END&#8217; control token over its channel.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>blocks</strong> &#8211; The channel end to stream addresses of blocks over</li>
<li><strong>preprocessedQuant</strong> &#8211; array of quantisation values.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dt><dl class="function">
<dt id="doDCT">
int <tt class="descname">doDCT</tt><big>(</big>streaming chanend<em>&nbsp;blocks</em>, int<em>&nbsp;dataBlock[64]</em><big>)</big><a class="headerlink" href="#doDCT" title="Permalink to this definition">¶</a></dt>
<dd><p>This is an Interface function to synchronously perform a DCT operation on a single datablock.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>blocks</strong> &#8211; The channelend that connects to the forwardDCT function.</li>
<li><strong>dataBlock</strong> &#8211; an 8x8 array of integers on which to perform a quantised DCT.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dt><dl class="function">
<dt id="endDCT">
void <tt class="descname">endDCT</tt><big>(</big>streaming chanend<em>&nbsp;blocks</em><big>)</big><a class="headerlink" href="#endDCT" title="Permalink to this definition">¶</a></dt>
<dd><p>This interface function terminates the forwardDCT function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>blocks</strong> &#8211; The channelend that connects to the forwardDCT function.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dt><dl class="function">
<dt id="quantDCT">
void <tt class="descname">quantDCT</tt><big>(</big>int<em>&nbsp;preprocessedQuant[65]</em>, const unsigned char<em>&nbsp;quantisationTable[64]</em><big>)</big><a class="headerlink" href="#quantDCT" title="Permalink to this definition">¶</a></dt>
<dd><p>This function preprocesses the quantisation table for use by forwardDCT.</p>
<p>Note that the preprocessed table is one word longer than the input table.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>quantisationTable</strong> &#8211; table with divider values for the quantisation process</li>
<li><strong>preprocessedQuant</strong> &#8211; table to be passed to forwardDCT</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="example-program">
<h2>Example program<a class="headerlink" href="#example-program" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>provideBlocks(streaming chanend toDCT) {</dt>
<dd><dl class="first docutils">
<dt>for(int i = 0; i &lt; 256; i++) {</dt>
<dd><dl class="first last docutils">
<dt>doDCT(block1); // This needs to be split</dt>
<dd>// And needs a better example</dd>
</dl>
</dd>
</dl>
<p class="last">}</p>
</dd>
</dl>
<p>}</p>
<dl class="docutils">
<dt>docompress(in quant[]) {</dt>
<dd><p class="first">int quant2[65];
quantDCT(quant2, quant);</p>
<dl class="docutils">
<dt>par {</dt>
<dd>forwardDCT(toDCT, quant2);
provideBlocks(toDCT, toHuffman);</dd>
</dl>
<p class="last">}</p>
</dd>
</dl>
<p>}</p>
</div>
</div>



          </div>
        </div>
      </div>
      <div class="sphinxsidebar" id='d2'>
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">DSP transformations (0v1)</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="fft.html">module_fft</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">module_dct_jpeg</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#api">API</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-program">Example program</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="huffman-jpeg.html">module_huffman_jpeg</a></li>
</ul>

<div id="searchbox" style="display: none;margin-bottom: 10px;">
  <h3>Search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>



    <div class="footer">
    </div>
  </body>
</html>



